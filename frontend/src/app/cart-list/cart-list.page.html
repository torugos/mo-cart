<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button default-href="#"></ion-back-button>
    </ion-buttons>
    <ion-title>Lista de Compras</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-grid style="width: 90%;">
    <ion-row class="table-header">
      <ion-col size="6">Produto</ion-col>
      <ion-col size="6">Preço</ion-col>
    </ion-row>
    
    <ion-row *ngFor="let item of lista">
      <ion-item-sliding>
        <ion-item-options side="start">
          <ion-item-option (click)="editModal(item.productId)">Editar</ion-item-option>
        </ion-item-options>

        <ion-item>
          <ion-label>{{item.name}}</ion-label>
          <ion-label>{{item.price | currency:'BRL'}}</ion-label>
        </ion-item>
  
        <ion-item-options side="end">
          <ion-item-option color="danger" expandable (click)="delete(item.productId)">Delete</ion-item-option>
        </ion-item-options>
      </ion-item-sliding>
    </ion-row>
  </ion-grid>

  <ion-fab slot="fixed" vertical="bottom" horizontal="end">
    <ion-fab-button expand="block" (click)="setAddOpen(true)">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <!-- Add Modal -->
  <ion-modal [isOpen]="isAddModalOpen" [backdropDismiss]="false">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Adicionar Produto</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="setAddOpen(false)">Close</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      
      <ion-content class="ion-content-center">
        <div class="center">
          <input type="text" class="custom-input" placeholder="Produto" [(ngModel)]="addProduct">
          <input
            type="text"
            class="custom-input"
            placeholder="Preço"
            currencyMask
            [options]="{ prefix: 'R$ ', thousands: '.', decimal: ',' }"
            [(ngModel)]="addPrice"
          >
        </div>
        <div class="center">
          <ion-button shape="round" (click)="saveAdd()">Incluir</ion-button>
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>

  <!-- Edit Modal -->
  <ion-modal [isOpen]="isEditModalOpen" [backdropDismiss]="false">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-title>Editar Produto</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="setEditOpen(false)">Close</ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>
      
      <ion-content class="ion-content-center">
        <div class="center">
          <input type="text" class="custom-input" placeholder="Produto" [(ngModel)]="editProduct">
          <input
            type="text"
            class="custom-input"
            placeholder="Preço"
            currencyMask
            [options]="{ prefix: 'R$ ', thousands: '.', decimal: ',' }"
            [(ngModel)]="editPrice"
          >
        </div>
        <div class="center">
          <ion-button shape="round" (click)="saveEdit()">Editar</ion-button>
        </div>
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>

<ion-footer>
  <ion-toolbar>
    <ion-title>Total da Compra: {{total | currency:'BRL'}}</ion-title>
  </ion-toolbar>
</ion-footer>